"use strict";var createElement=function(b,c,d){var f=document.createElement(b);return f.className=c,d&&(f.id=d),f},mainChatElement=document.getElementById("cognigy"),outerContainer=createElement("div","cognigy-outer-container__closed","cognigy-outer-container"),toggleChatState=createElement("div","cognigy-chat-state-closed","cognigy-toggle-state");toggleChatState.onclick=handleChatOpen,mainChatElement.appendChild(outerContainer),mainChatElement.appendChild(toggleChatState);var headerContainer=createElement("div","cognigy-chat-header-container__open","cognigy-header"),header=createElement("div","cognigy-chat-header"),headerText=createElement("div","cognigy-header-text"),headerTitle=createElement("span","cognigy-header-title"),headerSubtitle=createElement("span","cognigy-header-subtitle");headerTitle.appendChild(document.createTextNode("Chat")),headerSubtitle.appendChild(document.createTextNode("Online")),headerText.appendChild(headerTitle),headerText.appendChild(headerSubtitle);var avatar=createElement("img","cognigy-header-avatar");avatar.src="./images/cognigy_avatar.svg",avatar.id="cognigyHeaderLogo",header.appendChild(avatar);var headerMobileClose=createElement("div","displayNone","cognigy-toggle-state-mobile");headerMobileClose.onclick=handleChatOpen,header.appendChild(headerText),header.appendChild(headerMobileClose),headerContainer.appendChild(header),outerContainer.appendChild(headerContainer);var urlParameters={};window.location.search.slice(1).split("&").map(function(a){var b=a.substr(0,a.indexOf("=")),c=a.substr(a.indexOf("=")+1);urlParameters[b]=c});var chatContainer=createElement("div","cognigy-chat-container","cognigy-container");outerContainer.appendChild(chatContainer);var getStartedButton=createElement("button","cognigy-get-started-button","cognigy-get-started-button");if(urlParameters.getStartedText)var getStartedText=decodeURI(urlParameters.getStartedText);else var getStartedText="Get Started";if(urlParameters.getStartedPostback)var getStartedPostback=urlParameters.getStartedPostback;else var getStartedPostback="GET_STARTED";var getStartedButtonTitle=document.createTextNode("GET STARTED");getStartedButton.appendChild(getStartedButtonTitle),getStartedButton.onclick=function(){handleGetStartedButton(getStartedText,getStartedPostback)},outerContainer.appendChild(getStartedButton);var chatForm=createElement("form","displayNone","cognigy-form");outerContainer.appendChild(chatForm);var chatInput=createElement("div","cognigy-chat-input","cognigy-input");chatInput.setAttribute("data-text","Write a reply"),chatInput.contentEditable=!0,chatInput.returnKeyType="Send",function(){function a(b,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");return d.initCustomEvent(b,c.bubbles,c.cancelable,c.detail),d}return"function"!=typeof window.CustomEvent&&void(a.prototype=window.Event.prototype,window.CustomEvent=a)}();var messageEvent=new CustomEvent("submit",{cancelable:!0});chatInput.onkeydown=function(a){13!==a.keyCode||a.shiftKey?null:function(){a&&(a.preventDefault?a.preventDefault():a.returnValue=!1),document.getElementById("cognigy-form").dispatchEvent(messageEvent)}()},chatForm.appendChild(chatInput);var chatButton=createElement("button","cognigy-chat-button","cognigy-button"),sendAvatar=createElement("img","cognigy-send-icon");sendAvatar.src="./images/send.svg",chatButton.appendChild(sendAvatar),chatForm.appendChild(chatButton);var recordToggleButton=createElement("button","cognigy-record-toggle-button","cognigy-record-toggle");recordToggleButton.onclick=function(){handleRecordToggle()},recordToggleButton.type="button";var recordToggleAvatar=createElement("img","displayNone");urlParameters.recordButton&&(recordToggleAvatar.className="cognigy-record-toggle-icon"),recordToggleAvatar.src="./images/mic_on.svg",recordToggleButton.appendChild(recordToggleAvatar),chatForm.appendChild(recordToggleButton);var recordButton=createElement("button","displayNone","cognigy-record");recordButton.type="button",chatForm.insertBefore(recordButton,recordToggleButton);var fileUploadInput=createElement("input","cognigy-file-upload-input","cognigy-file-upload-input");fileUploadInput.type="file",fileUploadInput.multiple="true",fileUploadInput.onchange=function(){document.getElementById("cognigy-file-upload-form").dispatchEvent(messageEvent)};var fileUploadForm=createElement("form","displayNone","cognigy-file-upload-form");fileUploadForm.enctype="multipart/form-data",fileUploadForm.appendChild(fileUploadInput),chatForm.appendChild(fileUploadForm);var fileUploadButton=createElement("button","displayNone","cognigy-file-upload-button");fileUploadButton.type="button";var fileUploadAvatar=createElement("img","cognigy-file-upload-icon");fileUploadAvatar.src="./images/file_upload.svg",fileUploadButton.appendChild(fileUploadAvatar),chatForm.appendChild(fileUploadButton),urlParameters.fileUpload&&urlParameters.recordButton?(fileUploadForm.className="cognigy-file-upload-form",fileUploadButton.className="cognigy-file-upload-button"):urlParameters.fileUpload&&!urlParameters.recordButton&&(fileUploadForm.className="cognigy-file-upload-form",fileUploadButton.className="cognigy-file-upload-button-no-record-button",fileUploadInput.className="cognigy-file-upload-input-no-record-button");var recordToggled=!1;function handleRecordToggle(){recordToggled=!recordToggled,recordToggled?(recordToggleAvatar.src="./images/mic_off.svg",chatInput.className="displayNone",chatForm.style.justifyContent="center",recordButton.className="cognigy-record-button"):(recordToggleAvatar.src="./images/mic_on.svg",recordButton.className="displayNone",chatInput.className="cognigy-chat-input",chatForm.style.justifyContent="space-between")}function handleChatOpen(){var a=document.getElementById("cognigy-toggle-state"),b=document.getElementById("cognigy-toggle-state-mobile"),c=document.getElementById("cognigy-outer-container"),d=document.getElementById("cognigy-header");"cognigy-chat-state-closed"===a.className?(c.className="cognigy-outer-container__open",a.className="cognigy-chat-state-open",b.className="cognigy-mobile-close"):(c.className="cognigy-outer-container__closed",a.className="cognigy-chat-state-closed",b.className="displayNone")}function handleSendMessage(a){a&&(a.preventDefault?a.preventDefault():a.returnValue=!1);var b=document.getElementById("cognigy-input").innerHTML,c=/Â /g;b=b.replace(/<br>/g,"\n").replace(/&nbsp;/g,"");var d=document.getElementById("cognigy-container"),f=document.createElement("div"),g=document.createElement("div"),h=document.createTextNode(b);g.className="cognigy-chat-user-message",f.className="cognigy-chat-user-message-container",g.appendChild(h),f.appendChild(g);var i=document.createElement("img");i.className="cognigy-chat-user-avatar",i.src="./images/user_avatar.jpg",f.appendChild(i),d.appendChild(f),d.scrollTop=d.scrollHeight}var formElement=document.getElementById("cognigy-form");formElement.addEventListener("submit",function(a){a&&(a.preventDefault?a.preventDefault():a.returnValue=!1),handleSendMessage(a)},!1);function handleDisplayRecording(a){var b=document.getElementById("cognigy-container"),c=document.createElement("div"),d=document.createElement("div"),f=document.createTextNode(a);d.className="cognigy-chat-user-message",c.className="cognigy-chat-user-message-container",d.appendChild(f),c.appendChild(d);var g=document.createElement("img");g.className="cognigy-chat-user-avatar",g.src="./images/user_avatar.jpg",c.appendChild(g),b.appendChild(c),b.scrollTop=b.scrollHeight}function handleDisplayPostbackMessage(a){var b=document.getElementById("cognigy-container"),c=document.createElement("div"),d=document.createElement("div"),f=document.createTextNode(a.replace(/&nbsp;/g,""));d.className="cognigy-chat-user-message",c.className="cognigy-chat-user-message-container",d.appendChild(f),c.appendChild(d);var g=document.createElement("img");g.className="cognigy-chat-user-avatar",g.src="./images/user_avatar.jpg",c.appendChild(g),b.appendChild(c),b.scrollTop=b.scrollHeight}function displayCognigyMessage(a,b){if(!a||""===a.text)return null;var c=a&&a.text,d=document.getElementById("cognigy-container");if(a&&a.data&&(a.data.facebook||a.data._cognigy&&a.data._cognigy._facebook)){var f=new RichMessages(a.data,d);f.renderMessage()}else if("undefined"!=typeof c){var g=document.createElement("div"),h=document.createElement("div"),i=document.createTextNode(c),j=createElement("img","cognigy-chat-bot-avatar"),k=new Image;k.onload=function(){j.src=b},k.onerror=function(){j.src="./images/cognigy_logo.svg"},k.src=b,g.appendChild(j),h.className="cognigy-chat-bot-message",g.className="cognigy-chat-bot-message-container",h.appendChild(i),g.appendChild(h),d.appendChild(g),readCognigyMessage(c)}d.scrollTop=d.scrollHeight}function handleGetStartedButton(a,b){handleDisplayPostbackMessage(a),handleCognigyMessage(b),document.getElementById("cognigy-form").className="cognigy-chat-form",document.getElementById("cognigy-get-started-button").className="displayNone"}